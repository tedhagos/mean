
== File IO



[[filereadexample.js]]
[source,javascript]
.FileReadExample.js
----
const fs = require('fs'); // <1>
const filename = 'index.html';

fs.readFile(filename,'utf-8', function(err, data){
  if(err) { // <2>
    console.log(err.message);
  }
  else {
    console.log(data); // <3>
  }
});

----
<1> Import the `fs` library into our app. Anything that requires file io is
contained in this module
<2> If the call fails, `err` won't be null. Lots of things can cause
the `readFile()` to fail e.g. if the file is not there, the OS ran out
of file handles etc. If err isn't null, the `if` block will find it
_truthy_
<3> If the call succeeds, `err` will be null (falsy) and the contents
of the file would have been loaded into the second parameter of our
callback function

If you ran the code listing above, you would seen  an error message 
because the file _index.html_ does not exist yet. Create the html file
and save it on the same folder where _FileReadExample.js_ is located.

[[index.html]]
[source,html]
.index.html
----
<!DOCTYPE html>
<html>
  <h1>Hello World</h1>
</html>
----

Run the code sample again. This time, the contents of _index.html_
will be echoed to the screen.

=== Reading a File from a Web App

Let's use the file reading technique we learned in the last section
and apply it in a simple web app. The basic idea is as follows (1) The
user navigates to the root document or the home page (2) we will call a
function that will read an html file and (3) we will write the
contents of the html file into the `response` stream.

[[app.js]]
[source,javascript]
.app.js
----
const http = require('http');
const fs = require('fs');

const port = process.env.PORT || 3000;

http.createServer(function(req, res){
  var url = req.url.toUpperCase();
  switch(url) {
    case "/":
      // were in the home page
      break;
    case "/ABOUT":
      // were in the about page
      break;
    default:
      // Good place to write a 404 response
  }
});

----




=== Synchronous File Operation

image::images/1.png[]


=== Dealing with Asynchrony



